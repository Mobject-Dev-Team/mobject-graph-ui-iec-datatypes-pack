/**
 * MIT License
 *
 * Copyright (c) 2024 benhar-dev
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("mobject-graph-ui");class t extends e.DisplayWidget{constructor(t,n,o){super(t,n,o);const a=o?.content?.defaultValue||!1,i=o?.content?.datatype?.typeName||"",r=new e.ColorGenerator(i);this.ledComponent=new e.LedComponent(t,a,r),this.on("valueChanged",((e,t)=>{this.ledComponent.isActive=e}))}computeSize(){return this.ledComponent.computeSize()}draw(e,t,n,o,a){this.ledComponent.draw(e,t,n,o,a)}}class n extends e.ControlWidget{constructor(t,n,o){super(t,n,o);const a=o?.parameter?.defaultValue||!1,i=o?.parameter?.datatype?.typeName||"",r=new e.ColorGenerator(i);this.checkboxComponent=new e.CheckboxComponent(t,a,r),this.on("valueChanged",((e,t)=>{this.checkboxComponent.isChecked=e})),this.checkboxComponent.on("onChange",(e=>{this.value=e}))}computeSize(e,t){return this.checkboxComponent.computeSize(e,t)}mouse(e,t,n){this.checkboxComponent.onMouse(e,t)}draw(e,t,n,o,a){this.checkboxComponent.draw(e,t,n,o,a)}}class o{constructor(e){this.content=e,this.metadata=new Map((e.metadata??[]).map((e=>[e.name.toLowerCase(),e.value]))),this.datatype=e.datatype||{}}get precision(){return this.getMetadataOrDefault("precision",this.datatype.isFloat?2:0)}get defaultValue(){return this.content?.defaultValue||0}getMetadataOrDefault(e,t){return this.metadata.get(e.toLowerCase())||t}}class a{constructor(e){this.parameter=e,this.metadata=new Map((e.metadata??[]).map((e=>[e.name.toLowerCase(),e.value]))),this.datatype=e.datatype||{}}get minimumValue(){return this.getMetadataOrDefault("minimumValue",this.datatype.minValue||0)}get maximumValue(){return this.getMetadataOrDefault("maximumValue",this.datatype.maxValue||0)}get precision(){return this.getMetadataOrDefault("precision",this.datatype.isFloat?2:0)}get onlyOdd(){return this.getMetadataOrDefault("onlyOdd",!1)}get onlyEven(){return this.getMetadataOrDefault("onlyEven",!1)}get defaultValue(){return this.parameter.defaultValue}getMetadataOrDefault(e,t){return this.metadata.get(e.toLowerCase())||t}getNumberLimiter(){let t=null;return this.onlyOdd?t="odd":this.onlyEven&&(t="even"),new e.NumberLimiter(this.minimumValue,this.maximumValue,this.defaultValue,t,this.precision)}}class i extends e.DisplayWidget{constructor(t,n,a){super(t,n,a);const i=new o(a.content),r=i.defaultValue,s=i.precision,p=a?.content?.datatype?.typeName||"",u=new e.ColorGenerator(p);this.numericDisplayComponent=new e.NumericDisplayComponent(t,r,s,u),this.on("valueChanged",((e,t)=>{this.numericDisplayComponent.value=e}))}computeSize(){return this.numericDisplayComponent.computeSize()}draw(e,t,n,o,a){this.numericDisplayComponent.draw(e,t,n,o,a)}}class r extends e.ControlWidget{constructor(t,n,o){super(t,n,o);const i=new a(o.parameter),r=i.defaultValue,s=i.precision,p=i.getNumberLimiter(),u=o?.parameter?.datatype?.typeName||"",m=new e.ColorGenerator(u);this.numericInputComponent=new e.NumericInputComponent(t,r,s,p,m),this.on("valueChanged",((e,t)=>{this.numericInputComponent.value=e})),this.numericInputComponent.on("onChange",(e=>{this.value=e}))}computeSize(e,t){return this.numericInputComponent.computeSize(e,t)}mouse(e,t,n){this.numericInputComponent.onMouse(e,t,n)}draw(e,t,n,o,a){this.numericInputComponent.draw(e,t,n,o,a)}}class s extends e.DisplayWidget{constructor(t,n,o){super(t,n,o);const a=o?.content?.defaultValue||"",i=o?.content?.datatype?.typeName||"",r=new e.ColorGenerator(i);this.textDisplayComponent=new e.SingleLineTextDisplayComponent(t,a,r),this.on("valueChanged",((e,t)=>{this.textDisplayComponent.text=e}))}computeSize(){return this.textDisplayComponent.computeSize()}draw(e,t,n,o,a){this.textDisplayComponent.draw(e,t,n,o,a)}}class p extends e.ControlWidget{constructor(t,n,o){super(t,n,o);const a=o?.parameter?.defaultValue||"",i=o?.parameter?.datatype?.typeName||"",r=new e.ColorGenerator(i);this.textInputComponent=new e.SingleLineTextInputComponent(t,a,r),this.on("valueChanged",((e,t)=>{this.textInputComponent.text=e})),this.textInputComponent.on("onChange",(e=>{this.value=e}))}computeSize(e,t){return this.textInputComponent.computeSize(e,t)}mouse(e,t,n){this.textInputComponent.onMouse(e,t)}draw(e,t,n,o,a){this.textInputComponent.draw(e,t,n,o,a)}}class u extends e.DisplayWidget{constructor(t,n,o){super(t,n,o);const a=o?.content?.defaultValue||"",i=o?.content?.datatype?.typeName||"",r=new e.ColorGenerator(i);this.textDisplayComponent=new e.SingleLineTextDisplayComponent(t,a,r),this.on("valueChanged",((e,t)=>{this.textDisplayComponent.text=e}))}computeSize(){return this.textDisplayComponent.computeSize()}draw(e,t,n,o,a){this.textDisplayComponent.draw(e,t,n,o,a)}}class m extends e.ControlWidget{constructor(t,n,o){super(t,n,o);const a=o?.parameter?.defaultValue||"",i=o?.parameter?.datatype?.enumerations||[],r=o?.parameter?.datatype?.typeName||"",s=new e.ColorGenerator(r);this.comboboxComponent=new e.ComboboxComponent(t,a,i,s),this.on("valueChanged",((e,t)=>{this.comboboxComponent.selection=e})),this.comboboxComponent.on("onChange",(e=>{this.value=e}))}computeSize(e,t){return this.comboboxComponent.computeSize(e,t)}mouse(e,t,n){this.comboboxComponent.onMouse(e,t)}draw(e,t,n,o,a){this.comboboxComponent.draw(e,t,n,o,a)}}exports.IecDatatypesPack=class{install(t=new e.GraphFramework,n){this.registerWidgets(t,n)}registerWidgets(e,o){e.registerWidgetType(n,"BOOL"),e.registerWidgetType(t,"BOOL"),e.registerWidgetType(r,"BYTE"),e.registerWidgetType(i,"BYTE"),e.registerWidgetType(r,"WORD"),e.registerWidgetType(i,"WORD"),e.registerWidgetType(r,"DWORD"),e.registerWidgetType(i,"DWORD"),e.registerWidgetType(r,"LWORD"),e.registerWidgetType(i,"LWORD"),e.registerWidgetType(r,"INT"),e.registerWidgetType(i,"INT"),e.registerWidgetType(r,"LINT"),e.registerWidgetType(i,"LINT"),e.registerWidgetType(r,"DINT"),e.registerWidgetType(i,"DINT"),e.registerWidgetType(r,"SINT"),e.registerWidgetType(i,"SINT"),e.registerWidgetType(r,"USINT"),e.registerWidgetType(i,"USINT"),e.registerWidgetType(r,"UINT"),e.registerWidgetType(i,"UINT"),e.registerWidgetType(r,"UDINT"),e.registerWidgetType(i,"UDINT"),e.registerWidgetType(r,"ULINT"),e.registerWidgetType(i,"ULINT"),e.registerWidgetType(r,"REAL"),e.registerWidgetType(i,"REAL"),e.registerWidgetType(r,"LREAL"),e.registerWidgetType(i,"LREAL"),e.registerWidgetType(p,"STRING"),e.registerWidgetType(s,"STRING"),e.registerWidgetType(m,"ENUM","*"),e.registerWidgetType(u,"ENUM","*")}};
